package ru.bellintegrator;

import io.qameta.allure.Feature;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.CsvSource;
import pages.google.StartGoogle;
import pages.open.StartOpen;

public class GoogleOpenTest extends BaseTests{

    @Feature("Проверка результатов поиска в Google и курса валют на сайте Открытия")
    @DisplayName("Проверка результатов поиска c помощью PO")
    @ParameterizedTest(name = "{displayName}: {arguments}")
    @CsvSource({"Открытие, https://www.open.ru"})
    public void testPO(String keyWords, String result){
        chromeDriver.get("https://www.google.com/");
        StartGoogle startGoogle = new StartGoogle(chromeDriver);
        startGoogle.find(keyWords);
        chromeDriver.get(result);
        StartOpen startOpen = new StartOpen(chromeDriver);
        String usdSale = startOpen.getUsdSale().getText().replace(",", ".");
        String usdBuy = startOpen.getUsdBuy().getText().replace(",", ".");

        String eurSale = startOpen.getEurSale().getText().replace(",", ".");
        String eurBuy = startOpen.getEurBuy().getText().replace(",", ".");

        Assertions.assertTrue(Double.parseDouble(usdSale) > Double.parseDouble(usdBuy), "Продажа меньше покупки, можно разбогатеть на долларах");
        Assertions.assertTrue(Double.parseDouble(eurSale) > Double.parseDouble(eurBuy), "Продажа меньше покупки, можно разбогатеть на евро");

    }
}
